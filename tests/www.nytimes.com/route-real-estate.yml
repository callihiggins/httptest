tests:
  - description: 'Test real estate: "/real-estate/find-a-home" '
    request:
      path: /real-estate/find-a-home?gdpr=1
      headers:
        x-nyt-miss: "1"
    conditions:
      env:
        TEST_ENV: stg|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
          x-gdpr: ^1$
          set-cookie: (?:^|,)nyt-gdpr=(0|1);
      statusCodes:
        - 200
  - description: Test realestate querystring filter
    request:
      path: /real-estate/find-a-home?price=5&bad1=4&region=2&bad2=5&neighborhood=hello
      headers:
        x-nyt-miss: "1"
    conditions:
      env:
        TEST_ENV: stg|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
          x-nyt-final-url: ^/real-estate/find-a-home\?neighborhood=hello&price=5&region=2$
      statusCodes:
        - 200
  - description: Test realestate mobile redirect
    request:
      path: /real-estate/homes-for-sale/?locations%5B%5D=new-york-ny-usa&sortBy=dateposted-desc
      headers:
        x-nyt-miss: "1"
        User-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X)
          AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e
          Safari/8536.25
    conditions:
      env:
        TEST_ENV: stg|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
          location: ^https://m\.realestatelistings\.nytimes\.com/search\?channel=sales&search=See\+Available\+Homes&location=new-york-ny-usa$
      statusCodes:
        - 301
  - description: Test realestate mobile redirect
    request:
      path: /real-estate/homes-for-rent/?locations%5B%5D=new-york-ny-usa&sortBy=dateposted-desc
      headers:
        x-nyt-miss: "1"
        User-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X)
          AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e
          Safari/8536.25
    conditions:
      env:
        TEST_ENV: stg|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
          location: ^https://m\.realestatelistings\.nytimes\.com/search\?channel=rentals&search=See\+Available\+Homes&location=new-york-ny-usa$
      statusCodes:
        - 301
  - description: Test realestate mobile redirect
    request:
      path: /real-estate/usa/ny/new-york/upper-east-side/homes-for-sale
      headers:
        x-nyt-miss: "1"
        User-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X)
          AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e
          Safari/8536.25
    conditions:
      env:
        TEST_ENV: stg|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
          location: ^https://m\.realestatelistings\.nytimes\.com/search\?channel=sales&search=See\+Available\+Homes&location=upper-east-side-new-york-ny-usa$
      statusCodes:
        - 301
  - description: Test realestate mobile redirect
    request:
      path: /real-estate/usa/ny/new-york/upper-east-side/homes-for-rent
      headers:
        x-nyt-miss: "1"
        User-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X)
          AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e
          Safari/8536.25
    conditions:
      env:
        TEST_ENV: stg|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
          location: ^https://m\.realestatelistings\.nytimes\.com/search\?channel=rentals&search=See\+Available\+Homes&location=upper-east-side-new-york-ny-usa$
      statusCodes:
        - 301
  - description: Test realestate mobile redirect
    request:
      path: /real-estate/usa/ny/brooklyn/clinton-hill/homes-for-rent/333-washington-avenue/46-3257305
      headers:
        x-nyt-miss: "1"
        User-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X)
          AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e
          Safari/8536.25
    conditions:
      env:
        TEST_ENV: stg|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
          location: ^https://m\.realestatelistings\.nytimes\.com/listing/46-3257305$
      statusCodes:
        - 301
  - description: Test realestate mobile redirect
    request:
      path: /real-estate/usa/ny/brooklyn/clinton-hill/homes-for-sale/333-washington-avenue/46-3257305
      headers:
        x-nyt-miss: "1"
        User-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X)
          AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e
          Safari/8536.25
    conditions:
      env:
        TEST_ENV: stg|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
          location: ^https://m\.realestatelistings\.nytimes\.com/listing/46-3257305$
      statusCodes:
        - 301
  - description: Test realestate mobile redirect
    request:
      path: /real-estate/find-a-home
      headers:
        x-nyt-miss: "1"
        User-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X)
          AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e
          Safari/8536.25
    conditions:
      env:
        TEST_ENV: stg|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
          location: ^https://m\.realestatelistings\.nytimes\.com/$
      statusCodes:
        - 301
  - description: Test realestate mobile redirect
    request:
      path: /real-estate/my-real-estate
      headers:
        x-nyt-miss: "1"
        User-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X)
          AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e
          Safari/8536.25
    conditions:
      env:
        TEST_ENV: stg|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
          location: ^https://m\.realestatelistings\.nytimes\.com/savedlistings$
      statusCodes:
        - 301
  - description: Test realestate mortgage-calculator on DEV
    request:
      path: /real-estate/mortgage-calculator
      headers:
        x-nyt-miss: "1"
        User-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X)
          AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e
          Safari/8536.25
    conditions:
      env:
        TEST_ENV: dev|prd
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe$
      statusCodes:
        - 200
  - description: Test realestate mortgage-calculator redirect to vi on STG
    request:
      path: /real-estate/mortgage-calculator
      headers:
        x-nyt-miss: "1"
        User-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X)
          AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e
          Safari/8536.25
    conditions:
      env:
        TEST_ENV: stg
    response:
      headers:
        patterns:
          x-nyt-route: ^real-estate$
          x-nyt-backend: ^realestate_fe_vi$
      statusCodes:
        - 200

